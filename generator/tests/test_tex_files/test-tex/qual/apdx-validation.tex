% -*- TeX-master: "main"; fill-column: 72 -*-

\section{Validation of SBML documents}
\label{apdx-validation}

\subsection{Validation and consistency rules}
\label{validation-rules}

This section summarizes all the conditions that must (or in some cases,
at least \emph{should}) be true of an SBML Level~3 Version~1 model that
uses the \QualitativeModelsPackage. We use the same conventions as are
used in the SBML Level~3 Version~1 Core specification document. In
particular, there are different degrees of rule strictness. Formally,
the differences are expressed in the statement of a rule: either a rule
states that a condition \emph{must} be true, or a rule states that it
\emph{should} be true. Rules of the former kind are strict SBML
validation rules---a model encoded in SBML must conform to all of them
in order to be considered valid. Rules of the latter kind are
consistency rules. To help highlight these differences, we use the
following three symbols next to the rule numbers:

\begin{description}

\item[\hspace*{6.5pt}\vSymbol\vsp] A \vSymbolName indicates a
\emph{requirement} for SBML conformance. If a model does not follow this
rule, it does not conform to the \QualitativeModelsPackage
specification. (Mnemonic intention behind the choice of symbol: ``This
must be checked.'')

\item[\hspace*{6.5pt}\cSymbol\csp] A \cSymbolName indicates a
\emph{recommendation} for model consistency. If a model does not follow
this rule, it is not considered strictly invalid as far as the
\QualitativeModelsPackage specification is concerned; however, it
indicates that the model contains a physical or conceptual
inconsistency. (Mnemonic intention behind the choice of symbol: ``This
is a cause for warning.'')

\item[\hspace*{6.5pt}\mSymbol\msp] A \mSymbolName indicates a strong
recommendation for good modeling practice. This rule is not strictly a
matter of SBML encoding, but the recommendation comes from logical
reasoning. As in the previous case, if a model does not follow this
rule, it is not strictly considered an invalid SBML encoding. (Mnemonic
intention behind the choice of symbol: ``You're a star if you heed
this.'')

\end{description}

The validation rules listed in the following subsections are all stated
or implied in the rest of this specification document. They are
enumerated here for convenience. Unless explicitly stated, all
validation rules concern objects and attributes specifically defined in
the \QualitativeModelsPackage package.

For \notice convenience and brevity, we use the shorthand
``\token{qual:\-x}'' to stand for an attribute or element name \token{x}
in the namespace for the \QualitativeModelsPackage package, using the
namespace prefix \token{qual}. In reality, the prefix string may be
different from the literal ``\token{qual}'' used here (and indeed, it
can be any valid XML namespace prefix that the modeler or software
chooses). We use ``\token{qual:\-x}'' because it is shorter than to
write a full explanation everywhere we refer to an attribute or element
in the \QualitativeModelsPackage namespace.

\subsubsection*{General rules about this package}

\validRule{qual-10101}{To conform to the \QualitativeModelsPackage
specification for SBML Level~3 Version~1, an SBML document must declare
\uri{http://www.sbml.org/sbml/level3/version1/qual/version1} as the
XMLNamespace to use for elements of this package. (Reference: SBML
Level~3 Specification for Qualitative Models, Version~1
\sec{xml-namespace}.)}

\validRule{qual-10102}{Wherever they appear in an SBML document,
elements and attributes from the \QualitativeModelsPackage must use the
\uri{http://www.sbml.org/sbml/level3/version1/qual/version1} namespace,
declaring so either explicitly or implicitly. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1 \sec{xml-namespace}.)}

\subsubsection*{General rules about identifiers}

\validRule{qual-10301}{(Extends validation rule \#10301 in the
\sbmlthreecore specification. TO DO list scope of ids) (Reference: SBML
Level~3 Version~1 Core, Section~3.1.7.)}

\validRule{qual-10302}{The value of a \token{qual:\-id} must conform to
the syntax of the \class{SBML} data type \primtype{SId} (Reference: SBML
Level~3 Version~1 Core, Section~3.1.7.)}

\TODO{ANY LIST OF ELEMENTS THAT HAVE ATTRIBUTES}

\subsubsection*{Rules for the extended \class{SBML} class}

\validRule{qual-20101}{In all SBML documents using the
\QualitativeModelsPackage, the \class{SBML} object must have the
\token{qual:\-required} attribute. (Reference: SBML Level~3 Version~1
Core, Section~4.1.2.)}

\validRule{qual-20102}{The value of attribute \token{qual:\-required} on
the \class{SBML} object must be of data type \primtype{boolean}.
(Reference: SBML Level~3 Version~1 Core, Section~4.1.2.)}

\validRule{qual-20103}{The value of attribute \token{qual:\-required} on
the \class{SBML} object must be set to \val{false}. (Reference: SBML
Level~3 Specification for Qualitative Models, Version~1
\sec{xml-namespace}.)}

\subsubsection*{Rules for extended \class{Model} object}

\validRule{qual-20201}{A \Model object may contain one and only one
instance of each of the \ListOfQualitativeSpecies and \ListOfTransitions
elements. No other elements from the SBML Level~3 Qualitative Models
namespaces are permitted on a \Model object. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1,
\sec{extended-model-class}.)}

\validRule{qual-20202}{The \ListOfQualitativeSpecies and
\ListOfTransitions subobjects on a \Model object is optional, but if
present, these container objects must not be empty. (Reference: SBML
Level~3 Specification for Qualitative Models, Version~1,
\sec{extended-model-class}.)}

\validRule{qual-20203}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfQualitativeSpecies
container object may only contain \QualitativeSpecies objects.
(Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{extended-model-class}.)}

\validRule{qual-20204}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfTransitions container
object may only contain \Transition objects. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1,
\sec{extended-model-class}.)}

\validRule{qual-20205}{A \ListOfQualitativeSpecies object may have the
optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on a \ListOfQualitativeSpecies object.
(Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{extended-model-class}.)}

\validRule{qual-20206}{A \ListOfTransitions object may have the optional
SBML Level~3 Core attributes \token{metaid} and \token{sboTerm}. No
other attributes from the SBML Level~3 Core namespaces are permitted on
a \ListOfTransitions object. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{extended-model-class}.)}


\subsubsection*{Rules for \class{QualitativeSpecies} object}

\validRule{qual-20301}{A \QualitativeSpecies object may have the
optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on a \QualitativeSpecies. (Reference: SBML
Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20302}{A \QualitativeSpecies object may have the
optional SBML Level~3 Core subobjects for notes and annotations. No
other elements from the SBML Level~3 Core namespaces are permitted on a
\QualitativeSpecies. (Reference: SBML Level~3 Version~1 Core,
Section~3.2.)}

\validRule{qual-20303}{A \QualitativeSpecies object must have the
required attributes \token{qual:\-id}, \token{qual:\-compartment} and
\token{qual:\-constant}, and may have the optional attributes
\token{qual:\-name}, \token{qual:\-initialLevel} and
\token{qual:\-maxLevel}. No other attributes from the SBML Level~3
Qualitative Models namespaces are permitted on a \QualitativeSpecies
object. (Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{qualitativespecies-class}.)}

\validRule{qual-20304}{The value of the attribute
\token{qual:\-compartment} of a \QualitativeSpecies object must be the
identifier of an existing \Compartment object defined in the enclosing
\Model object. (Reference: SBML Level~3 Specification for Qualitative
Models, Version~1, \sec{qualitativespecies-class}.)}

\validRule{qual-20305}{The attribute \token{qual:\-constant} on a
\QualitativeSpecies must have a value of data type \token{boolean}.
(Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{qualitativespecies-class}.)}

\validRule{qual-20306}{The attribute \token{qual:\-name} on a
\QualitativeSpecies must have a value of data type \token{string}.
(Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{qualitativespecies-class}.)}

\validRule{qual-20307}{The attribute \token{qual:\-initialLevel} on a
\QualitativeSpecies must have a value of data type \token{integer}, and
must be non negative. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{qualitativespecies-class}.)}

\validRule{qual-20308}{The attribute \token{qual:\-maxLevel} on a
\QualitativeSpecies must have a value of data type \token{integer}, and
must be non negative. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{qualitativespecies-class}.)}


\subsubsection*{Rules for \class{Transition} object}

\validRule{qual-20401}{A \Transition object may have the optional SBML
Level~3 Core attributes \token{metaid} and \token{sboTerm}. No other
attributes from the SBML Level~3 Core namespaces are permitted on a
\Transition. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20402}{A \Transition object may have the optional SBML
Level~3 Core subobjects for notes and annotations. No other elements
from the SBML Level~3 Core namespaces are permitted on a \Transition.
(Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20403}{A \Transition object may have the optional
attributes \token{qual:\-id} and \token{qual:\-name}. No other
attributes from the SBML Level~3 Qualitative Models namespaces are
permitted on a \Transition object. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1,
\sec{transition-class}.)}

\validRule{qual-20404}{A \Transition object must contain one and only
one instance of the \ListOfFunctionTerms element, and may contain one
and only one instance of each of the \ListOfInputs and \ListOfOutputs
elements. No other elements from the SBML Level~3 Qualitative Models
namespaces are permitted on a \Transition object. (Reference: SBML
Level~3 Specification for Qualitative Models, Version~1,
\sec{transition-class}.)}

\validRule{qual-20405}{The attribute \token{qual:\-name} on a
\Transition must have a value of data type \token{string}. (Reference:
SBML Level~3 Specification for Qualitative Models, Version~1,
\sec{transition-class}.)}

\validRule{qual-20406}{The \ListOfInputs and \ListOfOutputs subobjects
on a \Transition object are optional, but if present, these container
objects must not be empty. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{transition-class}.)}

\validRule{qual-20407}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfInputs container
object may only contain \Input objects. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1,
\sec{listofinputs-class}.)}

\validRule{qual-20408}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfOutputs container
object may only contain \Output objects. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1,
\sec{listofoutputs-class}.)}

\validRule{qual-20409}{The \ListOfFunctionTerms subobject on a
\Transition object must not be empty. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1,
\sec{transition-class}.)}

\validRule{qual-20410}{Apart from the general notes and annotations
subobjects permitted on all SBML objects, a \ListOfFunctionTerms
container object may only contain \FunctionTerm objects. (Reference:
SBML Level~3 Specification for Qualitative Models, Version~1,
\sec{listoffunctionterms-class}.)}

\validRule{qual-20411}{A \ListOfInputs object may have the optional SBML
Level~3 Core attributes \token{metaid} and \token{sboTerm}. No other
attributes from the SBML Level~3 Core namespaces are permitted on a
\ListOfInputs object. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{listofinputs-class}.)}

\validRule{qual-20412}{A \ListOfOutputs object may have the optional
SBML Level~3 Core attributes \token{metaid} and \token{sboTerm}. No
other attributes from the SBML Level~3 Core namespaces are permitted on
a \ListOfOutputs object. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{listofoutputs-class}.)}

\validRule{qual-20413}{A \ListOfFunctionTerms object may have the
optional SBML Level~3 Core attributes \token{metaid} and
\token{sboTerm}. No other attributes from the SBML Level~3 Core
namespaces are permitted on a \ListOfFunctionTerms object. (Reference:
SBML Level~3 Specification for Qualitative Models, Version~1,
\sec{listoffunctionterms-class}.)}


\subsubsection*{Rules for \class{Input} object}

\validRule{qual-20501}{An \Input object may have the optional SBML
Level~3 Core attributes \token{metaid} and \token{sboTerm}. No other
attributes from the SBML Level~3 Core namespaces are permitted on an
\Input. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20502}{An \Input object may have the optional SBML
Level~3 Core subobjects for notes and annotations. No other elements
from the SBML Level~3 Core namespaces are permitted on an \Input.
(Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20503}{An \Input object must have the required attribute
\token{qual:\-qualitativeSpecies}, and may have the optional attributes
\token{qual:\-id}, \token{qual:\-name}, \token{qual:\-sign},
\token{qual:\-transitionEffect} and \token{qual:\-thresholdLevel}. No
other attributes from the SBML Level~3 Qualitative Models namespaces are
permitted on an \Input object. (Reference: SBML Level~3 Specification
for Qualitative Models, Version~1, \sec{input-class}.)}

\validRule{qual-20504}{The value of the attribute
\token{qual:\-qualitativeSpecies} of an \Input object must be the
identifier of an existing \QualitativeSpecies object defined in the
enclosing \Model object. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{input-class}.)}

\validRule{qual-20505}{The attribute \token{qual:\-name} on an \Input
must have a value of data type \token{string}. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1, \sec{input-class}.)}

\validRule{qual-20506}{The value of the attribute \token{qual:\-sign} of
an \Input object must conform to the syntax of SBML data type
\primtype{Sign} and may only take on the allowed values of
\primtype{Sign} defined in SBML; that is, the value must be one of the
following: \val{positive}, \val{negative}, \val{dual} or \val{unknown}.
(Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{input-class}.)}

\validRule{qual-20507}{The value of the attribute
\token{qual:\-transitionEffect} of an \Input object must conform to the
syntax of SBML data type \primtype{TransitionInputEffect} and may only
take on the allowed values of \primtype{TransitionInputEffect} defined
in SBML; that is, the value must be one of the following: \val{none} or
\val{consumption}. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{input-class}.)}

\validRule{qual-20508}{The attribute \token{qual:\-thresholdLevel} on an
\Input must have a value of data type \token{integer}, and must be non
negative. (Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{input-class}.)}


\subsubsection*{Rules for \class{Output} object}

\validRule{qual-20601}{An \Output object may have the optional SBML
Level~3 Core attributes \token{metaid} and \token{sboTerm}. No other
attributes from the SBML Level~3 Core namespaces are permitted on an
\Output. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20602}{An \Output object may have the optional SBML
Level~3 Core subobjects for notes and annotations. No other elements
from the SBML Level~3 Core namespaces are permitted on an \Output.
(Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20603}{An \Output object must have the required
attributes \token{qual:\-qualitativeSpecies} and
\token{qual:\-transitionEffect}, and may have the optional attributes
\token{qual:\-id}, \token{qual:\-name} and \token{qual:\-outputLevel}.
No other attributes from the SBML Level~3 Qualitative Models namespaces
are permitted on an \Output object. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1, \sec{output-class}.)}

\validRule{qual-20604}{The value of the attribute
\token{qual:\-qualitativeSpecies} of an \Output object must be the
identifier of an existing \QualitativeSpecies object defined in the
enclosing \Model object. (Reference: SBML Level~3 Specification for
Qualitative Models, Version~1, \sec{output-class}.)}

\validRule{qual-20605}{The value of the attribute
\token{qual:\-transitionEffect} of an \Output object must conform to the
syntax of SBML data type \primtype{TransitionOutputEffect} and may only
take on the allowed values of \primtype{TransitionOutputEffect} defined
in SBML; that is, the value must be one of the following:
\val{production} or \val{assignmentLevel}. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1, \sec{output-class}.)}

\validRule{qual-20606}{The attribute \token{qual:\-name} on an \Output
must have a value of data type \token{string}. (Reference: SBML Level~3
Specification for Qualitative Models, Version~1, \sec{output-class}.)}

\validRule{qual-20607}{The attribute \token{qual:\-outputLevel} on an
\Output must have a value of data type \token{integer}. (Reference: SBML
Level~3 Specification for Qualitative Models, Version~1,
\sec{output-class}.)}


\subsubsection*{Rules for \class{DefaultTerm} object}

\validRule{qual-20701}{A \DefaultTerm object may have the optional SBML
Level~3 Core attributes \token{metaid} and \token{sboTerm}. No other
attributes from the SBML Level~3 Core namespaces are permitted on a
\DefaultTerm. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20702}{A \DefaultTerm object may have the optional SBML
Level~3 Core subobjects for notes and annotations. No other elements
from the SBML Level~3 Core namespaces are permitted on a \DefaultTerm.
(Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20703}{A \DefaultTerm object must have the required
attribute \token{qual:\-resultLevel}. No other attributes from the SBML
Level~3 Qualitative Models namespaces are permitted on a \DefaultTerm
object. (Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{defaultterm-class}.)}

\validRule{qual-20704}{The attribute \token{qual:\-resultLevel} on a
\DefaultTerm must have a value of data type \token{integer}, and must be
non negative. (Reference: SBML Level~3 Specification for Qualitative
Models, Version~1, \sec{defaultterm-class}.)}


\subsubsection*{Rules for \class{FunctionTerm} object}

\validRule{qual-20801}{A \FunctionTerm object may have the optional SBML
Level~3 Core attributes \token{metaid} and \token{sboTerm}. No other
attributes from the SBML Level~3 Core namespaces are permitted on a
\FunctionTerm. (Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20802}{A \FunctionTerm object may have the optional SBML
Level~3 Core subobjects for notes and annotations. No other elements
from the SBML Level~3 Core namespaces are permitted on a \FunctionTerm.
(Reference: SBML Level~3 Version~1 Core, Section~3.2.)}

\validRule{qual-20803}{A \FunctionTerm object must have the required
attribute \token{qual:\-resultLevel}. No other attributes from the SBML
Level~3 Qualitative Models namespaces are permitted on a \FunctionTerm
object. (Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{functionterm-class}.)}

\validRule{qual-20804}{A \FunctionTerm object must contain one and only
one instance of the ASTNode element. No other elements from the SBML
Level~3 Qualitative Models namespaces are permitted on a \FunctionTerm
object. (Reference: SBML Level~3 Specification for Qualitative Models,
Version~1, \sec{functionterm-class}.)}

\validRule{qual-20805}{The attribute \token{qual:\-resultLevel} on a
\FunctionTerm must have a value of data type \token{integer}, and must
be non negative. (Reference: SBML Level~3 Specification for Qualitative
Models, Version~1, \sec{functionterm-class}.)}


